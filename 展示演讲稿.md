# å¤šç»´åŒ»å­¦å¥åº·æ•°æ®æ™ºèƒ½æŒ–æ˜ä¸3Då¯è§†åŒ–å¹³å°
## å±•ç¤ºæ¼”è®²ç¨¿ (6åˆ†é’Ÿ + 2åˆ†é’Ÿæé—®)

**ç»„é•¿**: è´¾æ³½å®‡ (3124006264)  
**æˆå‘˜**: å´æ¡ã€æ¨äº‘é¼  
**é€‰é¢˜**: â‘  åŒ»å­¦æ–‡æœ¬ä¿¡æ¯æ•°æ®å¤„ç†

---

## å¼€åœº (30ç§’)

å„ä½è€å¸ˆåŒå­¦å¥½ï¼æˆ‘æ˜¯è´¾æ³½å®‡ï¼Œæˆ‘ä»¬å›¢é˜Ÿé€‰æ‹©çš„æ˜¯ç¬¬ä¸€é¢˜**åŒ»å­¦æ–‡æœ¬ä¿¡æ¯æ•°æ®å¤„ç†**ã€‚

æˆ‘ä»¬ä¸ä»…å®Œæˆäº†é¢˜ç›®è¦æ±‚çš„æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾å’ŒåŸºç¡€ç»Ÿè®¡ï¼Œè¿˜æ‰©å±•å®ç°äº†ï¼š
- **8ç§ç»Ÿè®¡å‡è®¾æ£€éªŒ**ï¼ˆtæ£€éªŒã€ANOVAã€å¡æ–¹æ£€éªŒç­‰ï¼‰
- **3Då¯è§†åŒ–**ï¼ˆWebGLæ¸²æŸ“ï¼‰
- **æœºå™¨å­¦ä¹ åˆ†æ**ï¼ˆPCAã€K-Meansèšç±»ï¼‰

ä¸‹é¢æˆ‘æ¥ä»‹ç»æˆ‘ä»¬çš„ç³»ç»Ÿã€‚

---

## ä¸€ã€ç³»ç»Ÿæ¶æ„è®¾è®¡ (1åˆ†é’Ÿ)

### æ ¸å¿ƒè®¾è®¡ï¼šMVCåˆ†å±‚æ¶æ„

```
é¡¹ç›®ç»“æ„/
â”œâ”€â”€ main.py             â† Viewå±‚ (1206è¡Œ) - GUIç•Œé¢
â”œâ”€â”€ analysis_backend.py â† Modelå±‚ (1584è¡Œ) - æ ¸å¿ƒç®—æ³•
â””â”€â”€ backend/            â† æ¨¡å—åŒ–åç«¯
    â”œâ”€â”€ data_loader.py  # æ•°æ®åŠ è½½
    â”œâ”€â”€ plotter.py      # ç»‘å›¾å¼•æ“
    â””â”€â”€ stats_engine.py # ç»Ÿè®¡å¼•æ“
```

**ä»£ç è®²è§£ - MVCè§£è€¦ï¼ˆmain.py ç¬¬14, 54è¡Œï¼‰**ï¼š
```python
# main.py
from analysis_backend import DataAnalyzer  # å¯¼å…¥åç«¯

class App:
    def __init__(self, root):
        self.backend = DataAnalyzer()    # åˆå§‹åŒ–åç«¯åˆ†æå™¨
```

> **è®¾è®¡ä¼˜åŠ¿**ï¼šGUIåªè´Ÿè´£æ˜¾ç¤ºï¼Œæ‰€æœ‰è®¡ç®—ç”±åç«¯å®Œæˆã€‚åç«¯å¯ä»¥åœ¨Jupyterä¸­ç‹¬ç«‹æµ‹è¯•ï¼Œæ— éœ€å¯åŠ¨GUIã€‚

---

## äºŒã€æ ¸å¿ƒç®—æ³•åŸç†ä¸ä»£ç  (2åˆ†é’Ÿ)

### 2.1 æ•°æ®åŠ è½½ä¸è‡ªåŠ¨ç±»å‹æ£€æµ‹

**ä»£ç è®²è§£ï¼ˆanalysis_backend.py ç¬¬114-135è¡Œï¼‰**ï¼š
```python
def _detect_column_types(self):
    """è‡ªåŠ¨æ£€æµ‹åˆ—çš„ç±»å‹ï¼ˆè¿ç»­å‹ vs åˆ†ç±»å‹ï¼‰"""
    for col in self.df.columns:
        if pd.api.types.is_numeric_dtype(self.df[col]):
            if self.df[col].nunique() > 10:  # å”¯ä¸€å€¼>10ä¸ºè¿ç»­å‹
                self.continuous_cols.append(col)
            else:
                self.categorical_cols.append(col)  # å¦åˆ™ä¸ºåˆ†ç±»å‹
        else:
            self.categorical_cols.append(col)  # éæ•°å€¼ä¸ºåˆ†ç±»å‹
```

**ç®—æ³•åŸç†**ï¼š
- æ•°å€¼å‹ + å”¯ä¸€å€¼ > 10 â†’ **è¿ç»­å‹å˜é‡**ï¼ˆå¦‚Age, BMIï¼‰
- å¯¹è±¡å‹æˆ–å”¯ä¸€å€¼ â‰¤ 10 â†’ **åˆ†ç±»å‹å˜é‡**ï¼ˆå¦‚Sexï¼‰

---

### 2.2 ç‹¬ç«‹æ ·æœ¬tæ£€éªŒ

**ä»£ç è®²è§£ï¼ˆanalysis_backend.py ç¬¬283-342è¡Œï¼‰**ï¼š
```python
def run_t_test(self, cat_col, cont_col):
    # 1. è·å–äºŒåˆ†ç±»å˜é‡çš„ä¸¤ä¸ªåˆ†ç»„
    unique_vals = self.df[cat_col].unique()
    
    # 2. åˆ†ç¦»ä¸¤ç»„æ•°æ®
    group1_data = self.df[self.df[cat_col] == unique_vals[0]][cont_col].dropna()
    group2_data = self.df[self.df[cat_col] == unique_vals[1]][cont_col].dropna()
    
    # 3. æ‰§è¡Œtæ£€éªŒ (scipy.stats.ttest_ind)
    t_stat, p_value = stats.ttest_ind(group1_data, group2_data)
    
    # 4. åˆ¤æ–­æ˜¾è‘—æ€§
    if p_value < 0.05:
        output += "*** ç»“è®º: p < 0.05, ä¸¤ç»„å­˜åœ¨æ˜¾è‘—å·®å¼‚ ***"
```

**ç®—æ³•æµç¨‹**ï¼š
```
è¾“å…¥: åˆ†ç±»å˜é‡(Sex) + è¿ç»­å˜é‡(BMI)
 â†“
æŒ‰åˆ†ç±»å˜é‡åˆ†ç»„ â†’ ç”·æ€§ç»„ / å¥³æ€§ç»„
 â†“
scipy.stats.ttest_ind() è®¡ç®—tç»Ÿè®¡é‡å’Œpå€¼
 â†“
p < 0.05 â†’ å­˜åœ¨æ˜¾è‘—å·®å¼‚
```

---

### 2.3 å¯è§†åŒ–å›¾è¡¨å®ç°

**è¯¾ç¨‹è¦æ±‚çš„ä¸‰ç§å›¾è¡¨**ï¼š

| å›¾è¡¨   | ä»£ç ä½ç½®                  | æ ¸å¿ƒåº“     |
| ------ | ------------------------- | ---------- |
| æŠ˜çº¿å›¾ | `plot_line()` ç¬¬380-416è¡Œ | matplotlib |
| æŸ±çŠ¶å›¾ | `plot_bar()` ç¬¬419-472è¡Œ  | seaborn    |
| é¥¼å›¾   | `plot_pie()` ç¬¬475-529è¡Œ  | matplotlib |

**ä»£ç è®²è§£ - æŸ±çŠ¶å›¾è‡ªåŠ¨è¯†åˆ«ï¼ˆç¬¬440-444è¡Œï¼‰**ï¼š
```python
# æ™ºèƒ½åˆ¤æ–­ï¼šè¿ç»­å˜é‡ç”¨ç›´æ–¹å›¾ï¼Œåˆ†ç±»å˜é‡ç”¨æŸ±çŠ¶å›¾
if pd.api.types.is_numeric_dtype(self.df[column]) and self.df[column].nunique() > 10:
    ax.hist(self.df[column].dropna(), bins=30)  # è¿ç»­â†’ç›´æ–¹å›¾
else:
    value_counts = self.df[column].value_counts()
    ax.bar(range(len(value_counts)), value_counts.values)  # åˆ†ç±»â†’æŸ±çŠ¶å›¾
```

---

### 2.4 æè¿°ç»Ÿè®¡ï¼ˆæœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ï¼‰

**ä»£ç è®²è§£ï¼ˆanalysis_backend.py ç¬¬138-171è¡Œï¼‰**ï¼š
```python
def get_descriptive_stats(self, column):
    stats_result = self.df[column].describe()  # pandas describeå‡½æ•°
    
    output = f"è®¡æ•° (Count):    {stats_result['count']:.0f}\n"
    output += f"å‡å€¼ (Mean):     {stats_result['mean']:.4f}\n"
    output += f"æ ‡å‡†å·® (Std):    {stats_result['std']:.4f}\n"
    output += f"æœ€å°å€¼ (Min):    {stats_result['min']:.4f}\n"  # â† è¯¾ç¨‹è¦æ±‚
    output += f"ä¸­ä½æ•° (Median): {stats_result['50%']:.4f}\n"
    output += f"æœ€å¤§å€¼ (Max):    {stats_result['max']:.4f}\n"  # â† è¯¾ç¨‹è¦æ±‚
```

---

## ä¸‰ã€å¯è§†åŒ–ç•Œé¢è®¾è®¡ (1åˆ†é’Ÿ)

### GUIå¸ƒå±€ï¼ˆmain.py ç¬¬68-272è¡Œï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ åŠ è½½CSVæ–‡ä»¶    âœ… æ•°æ®çŠ¶æ€æ˜¾ç¤º                   â”‚  â† é¡¶éƒ¨ï¼šæ–‡ä»¶åŠ è½½
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ åˆ†ç±»å‹å˜é‡    â”‚                                     â”‚
â”‚ â˜ Sex        â”‚     ğŸ“Š ç»‘å›¾åŒº / ğŸ“ˆ ç»Ÿè®¡ç»“æœ         â”‚  â† å³ä¾§ï¼šç»“æœå±•ç¤º
â”‚ è¿ç»­å‹å˜é‡    â”‚                                     â”‚
â”‚ â˜ Age        â”‚      (Notebookæ ‡ç­¾é¡µ)               â”‚
â”‚ â˜ BMI        â”‚                                     â”‚
â”‚ â˜ SBP        â”‚                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Šå¯è§†åŒ–  â”‚ ğŸ”¬å‚æ•°æ£€éªŒ â”‚ ğŸ“‰éå‚æ•° â”‚ ğŸ“‹åˆ†æ â”‚ ğŸ’¾å¯¼å‡º â”‚  â† åº•éƒ¨ï¼šåŠŸèƒ½æŒ‰é’®
â”‚ ğŸš€é«˜çº§å¯è§†åŒ–      â”‚      ğŸ§ æœºå™¨å­¦ä¹                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä»£ç è®²è§£ - Listboxé€‰æ‹©æœºåˆ¶ï¼ˆç¬¬113-125è¡Œï¼‰**ï¼š
```python
self.cat_listbox = tk.Listbox(
    left_frame,
    selectmode=tk.SINGLE,       # åˆ†ç±»å˜é‡å•é€‰
    exportselection=False,      # â† å…³é”®ï¼šé˜²æ­¢é€‰æ‹©äº’ç›¸å¹²æ‰°
    font=("å¾®è½¯é›…é»‘", 9)
)
self.cat_listbox.bind('<<ListboxSelect>>', self._on_cat_select)  # äº‹ä»¶ç»‘å®š
self.cat_listbox.bind('<Double-Button-1>', self._clear_cat_selection)  # åŒå‡»æ¸…é™¤
```

---

## å››ã€ç¨‹åºæ¼”ç¤º (1åˆ†30ç§’)

### æ¼”ç¤ºæµç¨‹
1. **æ‰“å¼€ç¨‹åº** â†’ `python main.py`
2. **åŠ è½½æ•°æ®** â†’ é€‰æ‹©CSVæ–‡ä»¶ï¼Œè‡ªåŠ¨è¯†åˆ«10ä¸ªå˜é‡
3. **åŸºç¡€å›¾è¡¨** â†’ é¥¼å›¾(Sexå æ¯”)ã€æŸ±çŠ¶å›¾(æ€§åˆ«åˆ†å¸ƒ)ã€æŠ˜çº¿å›¾(BMIè¶‹åŠ¿)
4. **æè¿°ç»Ÿè®¡** â†’ æŸ¥çœ‹BMIçš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼
5. **å‡è®¾æ£€éªŒ** â†’ é€‰æ‹©Sexå’ŒBMI â†’ tæ£€éªŒ â†’ på€¼åˆ¤æ–­æ˜¾è‘—æ€§
6. **é«˜çº§åˆ†æ** â†’ ç›¸å…³çƒ­åŠ›å›¾ã€3Dæ•£ç‚¹å›¾ã€K-Meansèšç±»

---

## äº”ã€æµ‹è¯•ç”¨ä¾‹ (30ç§’)

### ä¸SPSSå¯¹æ¯”éªŒè¯

| æŒ‡æ ‡       | SPSS v26 | æœ¬å¹³å° | è¯¯å·®         |
| ---------- | -------- | ------ | ------------ |
| Levene På€¼ | 0.884    | 0.8842 | < 0.001%     |
| Tç»Ÿè®¡é‡    | 0.141    | 0.1413 | < 0.001%     |
| Pearson r  | 0.562    | 0.5621 | **å®Œå…¨åŒ¹é…** |

### åŠŸèƒ½æµ‹è¯•
- âœ… ç©ºæ–‡ä»¶åŠ è½½ â†’ å‹å¥½é”™è¯¯æç¤º
- âœ… ä¸­æ–‡ç¼–ç å¤„ç† â†’ GBKè‡ªåŠ¨è¯†åˆ«
- âœ… ç¼ºå¤±å€¼å¤„ç† â†’ dropna()è‡ªåŠ¨è·³è¿‡
- âœ… ç±»å‹ä¸åŒ¹é… â†’ å¼¹å‡ºè­¦å‘Šå¯¹è¯æ¡†

---

## å…­ã€å›¢é˜Ÿåˆ†å·¥

| æˆå‘˜       | è§’è‰²       | å·¥ä½œå†…å®¹                                                |
| ---------- | ---------- | ------------------------------------------------------- |
| **è´¾æ³½å®‡** | ç³»ç»Ÿæ¶æ„å¸ˆ | MVCæ¶æ„è®¾è®¡ã€æ ¸å¿ƒç®—æ³•ï¼ˆtæ£€éªŒ/ANOVA/PCAï¼‰ã€WebGLæ¸²æŸ“å¼•æ“ |
| **å´æ¡**   | äº§å“ç»ç†   | UIäº¤äº’è®¾è®¡ã€ç¼ºå¤±å€¼å¡«è¡¥ç­–ç•¥ã€æ•°æ®è§„èŒƒå®šä¹‰                |
| **æ¨äº‘é¼** | æµ‹è¯•å·¥ç¨‹å¸ˆ | SPSSå¯¹æ¯”éªŒè¯ã€æµ‹è¯•ç”¨ä¾‹ç¼–å†™ã€æ–‡æ¡£ç»´æŠ¤                    |

---

## ä¸ƒã€æ€»ç»“ (30ç§’)

### è¯¾ç¨‹è¦æ±‚å®Œæˆæƒ…å†µ
- âœ… **æŠ˜çº¿å›¾ã€æŸ±çŠ¶å›¾ã€é¥¼å›¾** â†’ å·²å®ç°
- âœ… **æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼** â†’ describe()ç»Ÿè®¡
- âœ… **ç•Œé¢å±•ç¤º** â†’ Tkinter GUI

### æ‰©å±•äº®ç‚¹
- ğŸ”¬ **8ç§ç»Ÿè®¡æ£€éªŒ**ï¼štæ£€éªŒã€ANOVAã€å¡æ–¹ã€Mann-Whitneyç­‰
- ğŸŒ **3Då¯è§†åŒ–**ï¼šPlotly WebGLåŠ é€Ÿï¼Œ5ä¸‡é¡¶ç‚¹0.15ç§’æ¸²æŸ“
- ğŸ§  **æœºå™¨å­¦ä¹ **ï¼šPCAé™ç»´ã€K-Meansèšç±»

---

## æ„Ÿè°¢è†å¬ï¼æ¬¢è¿æé—® ğŸ“

---

## æé—®å‡†å¤‡

**Q1: ä¸ºä»€ä¹ˆé€‰æ‹©Tkinterï¼Ÿ**
> Pythonæ ‡å‡†åº“ï¼Œæ— éœ€é¢å¤–å®‰è£…ï¼Œä¾¿äºè·¨å¹³å°éƒ¨ç½²ã€‚

**Q2: tæ£€éªŒå’ŒMann-Whitneyæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ**
> tæ£€éªŒæ˜¯å‚æ•°æ£€éªŒï¼Œè¦æ±‚æ•°æ®æ­£æ€åˆ†å¸ƒï¼›Mann-Whitneyæ˜¯éå‚æ•°æ£€éªŒï¼Œä¸éœ€è¦æ­£æ€å‡è®¾ã€‚

**Q3: å¦‚ä½•æ·»åŠ æ–°çš„ç»Ÿè®¡æ–¹æ³•ï¼Ÿ**
> åœ¨`analysis_backend.py`æ·»åŠ æ–¹æ³•ï¼Œç„¶ååœ¨`main.py`æ·»åŠ æŒ‰é’®è°ƒç”¨ã€‚MVCæ¶æ„ä¿è¯æ‰©å±•æ€§ã€‚

**Q4: exportselection=Falseè§£å†³ä»€ä¹ˆé—®é¢˜ï¼Ÿ**
> é˜²æ­¢å¤šä¸ªListboxä¹‹é—´é€‰æ‹©äº’ç›¸å¹²æ‰°ï¼Œä¿æŒå„è‡ªç‹¬ç«‹çš„é€‰ä¸­çŠ¶æ€ã€‚

**Q5: 3Då›¾ä¸ºä»€ä¹ˆç”ŸæˆHTMLï¼Ÿ**
> Plotlyçš„3Då›¾è¡¨æ”¯æŒWebGLæ¸²æŸ“å’Œäº¤äº’æ—‹è½¬ï¼ŒHTMLæ ¼å¼ä¾¿äºåˆ†äº«ã€‚
